---
title: Servermanagercmd
description: '适用于 * * * * 的 Windows 命令主题 '
ms.custom: na
ms.prod: windows-server
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 507c4b87-8e13-4872-8b34-0c7508eecbc1
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 07/11/2018
ms.openlocfilehash: b47947f8f98ba3bb7e5192713b3cf3b75b9c0212
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/27/2019
ms.locfileid: "71384150"
---
# <a name="servermanagercmd"></a>Servermanagercmd

>适用于：Windows Server （半年频道），Windows Server 2016，Windows Server 2012 R2，Windows Server 2012

> [!IMPORTANT]
> 此命令仅在运行 Windows Server 2008 或 Windows Server 2008 R2 的服务器上可用。 **Servermanagercmd.exe**已被弃用，在 Windows Server 2012 中不可用。 有关如何在 Windows Server 2012 中安装或删除角色、角色服务和功能的信息，请参阅 Microsoft TechNet 上的[安装或卸载角色、角色服务和功能](https://go.microsoft.com/fwlink/?LinkID=239563)。

安装和删除角色、角色服务和功能。 还显示了可用的所有角色、角色服务和功能的列表，并显示在此计算机上安装的。 有关使用此工具可以指定的角色、角色服务和功能的其他信息，请参阅[服务器管理器帮助](https://go.microsoft.com/fwlink/?LinkID=137387)。 有关如何使用此命令的示例，请参阅[示例](#BKMK_examples)。

## <a name="syntax"></a>语法
```
servermanagercmd -query [[[<Drive>:]<path>]<query.xml>] [-logpath   [[<Drive>:]<path>]<log.txt>]
servermanagercmd -inputpath  [[<Drive>:]<path>]<answer.xml> [-resultpath <result.xml> [-restart] | -whatif] [-logpath [[<Drive>:]<path>]<log.txt>]
servermanagercmd -install <Id> [-allSubFeatures] [-resultpath   [[<Drive>:]<path>]<result.xml> [-restart] | -whatif] [-logpath   [[<Drive>:]<path>]<log.txt>]
servermanagercmd -remove <Id> [-resultpath    <result.xml> [-restart] | -whatif] [-logpath  [[<Drive>:]<path>]<log.txt>]
servermanagercmd [-help | -?]
servermanagercmd -version
```

## <a name="parameters"></a>Parameters

|                   参数                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  -query [[[\<Drive >：] \<path > *] \< >* ]   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                显示在服务器上安装的所有角色、角色服务和功能的列表。 你还可以使用此参数的缩写形式 **-q**。 如果要将查询结果保存到 XML 文件中，请指定一个 XML 文件来替换*query .xml*。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| -inputpath < [[@no__t 0Drive >：] \<path >]*解答 xml*@no__t |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             安装或删除 XML 应答文件中指定的角色、角色服务和*功能。* 你还可以使用此参数的缩写形式 **-p。**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|                -install @no__t*Id*>                | 安装由*Id*指定的角色、角色服务或功能。标识符不区分大小写。 多个角色、角色服务和功能必须由空格分隔。 以下可选参数与 **-install**参数一起使用。<br /><br />-    **-设置**\<*SettingName*>= @ no__t*SettingValue*> 指定安装所需的设置。<br />@no__t-**allSubFeatures**指定安装所有从属服务和功能，以及*Id*值中命名的父角色、角色服务或功能。 **注意：**    有些角色容器没有允许安装所有角色服务的命令行标识符。 当无法在服务器管理器命令的同一实例中安装角色服务时，就会出现这种情况。 例如，active directory 联合身份验证服务和联合身份验证服务代理角色服务的联合身份验证服务角色服务不能使用相同的服务器管理器命令实例来安装。<br />@no__t **@no__t-** 2 result，*xml > 将安装结果保存到 \*RESULT 表示的 xml 文件*。 你还可以使用此参数的缩写形式 **-r**。 **注意：**    不能同时指定 **-resultpath**参数和 **-whatif**参数运行**servermanagercmd.exe** 。<br />-    **-重新启动**完成安装时自动重新启动计算机（如果所安装的角色或功能需要重新启动）。<br />@no__t-**whatif**显示为 **-install**参数指定的任何操作。 还可以使用 **-whatif**参数的缩写形式 **-w**。 不能同时指定 **-resultpath**参数和 **-whatif**参数运行**servermanagercmd.exe** 。<br />@no__t **@no__t-** 2 [[\<Drive >：] \<path >]*Log .txt*> 指定日志文件的名称和位置，而不是默认的 **%windir%\temp\servermanager.log**。 |
|                -remove @no__t*Id*>                 |                                                                                                                                                                                                                                                                                                                                                                     删除由*Id*指定的角色、角色服务或功能。标识符不区分大小写。 多个角色、角色服务和功能必须由空格分隔。 以下可选参数与 **-remove**参数一起使用。<br /><br />-    **-resultpath** \< [[\<Drive >：] \<path >]*result*> 将删除结果保存到 xml 文件*中。* 你还可以使用此参数的缩写形式 **-r**。 **注意：**    不能同时指定 **-resultpath**参数和 **-whatif**参数运行**servermanagercmd.exe** 。<br />-    **-重新启动**完成后自动重新启动计算机（如果剩余角色或功能需要重新启动）。<br />@no__t-**whatif**显示为 **-remove**参数指定的任何操作。 还可以使用 **-whatif**参数的缩写形式 **-w**。 不能同时指定 **-resultpath**参数和 **-whatif**参数运行**servermanagercmd.exe** 。<br />@no__t **@no__t-** 2 [[\<Drive >：] \<path >]*Log .txt*> 指定日志文件的名称和位置，而不是默认的 **%windir%\temp\servermanager.log**。                                                                                                                                                                                                                                                                                                                                                                      |
|                     -help                      |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            在命令提示符窗口中显示帮助。 还可以使用缩写形式 **-？** 。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|                    -版本                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            显示服务器管理器版本号。 还可以使用缩写形式 **-v**。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

## <a name="remarks"></a>备注
**Servermanagercmd.exe**已被弃用，且在未来版本的 Windows 中不能保证受支持。 建议你在运行 Windows Server 2008 R2 的计算机上运行服务器管理器，并使用可用于服务器管理器的 Windows PowerShell cmdlet。 有关详细信息，请参阅[服务器管理器 cmdlet](https://go.microsoft.com/fwlink/?LinkID=137653)。
可以从服务器本地驱动器上的任何目录运行 servermanagercmd.exe。 您必须是要在其上安装或删除软件的服务器上的 "管理员" 组的成员。

> [!IMPORTANT]
> 由于 Windows Server 2008 R2 中用户帐户控制施加的安全限制，你必须在使用提升的权限打开的命令提示符窗口中运行**servermanagercmd.exe** 。 为此，请右键单击命令提示符可执行文件或 "**开始**" 菜单上的 "**命令提示符**" 对象，然后单击 "以**管理员身份运行**"。

## <a name="BKMK_examples"></a>示例
下面的示例演示如何使用**servermanagercmd.exe**显示所有角色、角色服务和功能的列表，以及在计算机上安装的角色、角色服务和功能。
```
servermanagercmd -query
```
下面的示例演示如何使用**servermanagercmd.exe**来安装 Web 服务器（IIS）角色，并将安装结果保存到*INSTALLRESULT*表示的 xml 文件。
```
servermanagercmd -install Web-Server -resultpath installResult.xml
```
下面的示例演示如何在**servermanagercmd.exe**中使用**whatif**参数来显示有关要安装或删除的角色、角色服务和功能的详细信息，具体取决于在*Xml 应答文件。*
```
servermanagercmd -inputpath install.xml -whatif
```

#### <a name="additional-references"></a>其他参考
-   有关可以为*Id*参数指定的角色、角色服务或功能标识符的完整列表，或有关将 XML 答案文件与**servermanagercmd.exe**结合使用的详细信息，请参阅[服务器管理器帮助](https://go.microsoft.com/fwlink/?LinkID=137387)。 (https://go.microsoft.com/fwlink/?LinkID=137387).
-   有关可用于服务器管理器的 Windows PowerShell cmdlet 的列表，请参阅[服务器管理器 cmdlet](https://go.microsoft.com/fwlink/?LinkID=137653) 。
-   [命令行语法项](command-line-syntax-key.md)
