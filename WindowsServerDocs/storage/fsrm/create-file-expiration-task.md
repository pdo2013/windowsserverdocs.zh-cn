---
title: 创建文件过期任务
description: 本文介绍为即将过期的文件创建文件管理任务的流程
ms.date: 7/7/2017
ms.prod: windows-server-threshold
ms.technology: storage
ms.topic: article
author: JasonGerend
manager: brianlic
ms.author: jgerend
ms.openlocfilehash: b3aa535128786d0de5c1a5ef7186e26aa62b478d
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/17/2019
ms.locfileid: "59859298"
---
# <a name="create-a-file-expiration-task"></a>创建文件过期任务

> 适用于：Windows Server （半年频道）、 Windows Server 2016、 Windows Server 2012 R2、 Windows Server 2012、 Windows Server 2008 R2

以下过程指导你完成为即将过期的文件创建文件管理任务的流程。 文件过期任务用于自动将匹配某些条件的所有文件移动到指定的过期目录，在此管理员可以备份这些文件并将它们删除。

当运行文件过期任务时，过期目录中将创建一个新目录，按照运行任务的服务器名称对目录进行分组。

新目录的名称基于文件管理任务的名称以及运行任务的时间。 发现过期文件时，会将该文件移动到这个新的目录，同时保留其初始的目录结构。

## <a name="to-create-a-file-expiration-task"></a>若要创建文件过期任务，请执行以下操作：

1.  单击“文件管理任务”节点。

2.  右键单击**文件管理任务**，然后单击**创建文件管理任务**（或单击**窗格**中的**创建文件管理任务**）。 此操作将打开“创建文件管理任务”对话框。

3.  在“常规”选项卡上，输入下列信息：

    -   “名称”。 输入新任务的名称。  

    -   “说明”。 输入该任务的可选说明性标签。  
    
    -   **范围**。 使用**添加**按钮添加应在其中操作该任务的目录。 或者，可使用**删除**按钮从列表中删除目录。 文件管理任务适用于此列表中所有文件夹及其子文件夹。

4.  在“操作”选项卡上，输入下列信息：

    -   “类型”。 选择下拉框中的**文件过期**。

    -   “过期目录”。 选择其中的文件将过期的目录。

     > [!Warning]
     > 如上述步骤中所规定，请勿选择任务作用域内的目录。 这样做可能导致迭代循环，这会造成系统不稳定和数据丢失。

5.  另外，在**通知**选项卡上单击**添加**以发送电子邮件通知、记录事件、运行命令或编写任务对文件执行操作之前指定最少天数的脚本。

    -   在**执行任务发送通知所需的天数**组合框中键入或选择一个值，以指定将通过通知发送、对文件执行操作前的最少天数。

     > [!Note]
     > 通知仅在任务运行时发送。 如果指定的发送通知的最少天数不符合计划的任务，则通知前一个计划任务当天发送。

    -   若要配置电子邮件通知，请单击**电子邮件**选项卡，然后输入以下信息：

        -   若要在达到阈值时通知管理员，请选中**将电子邮件发送至下列管理员**复选框，然后输入将收到通知的管理帐户名称。 请使用 *account@domain* 格式，并使用分号隔开多个帐户。  

        -   若要向其文件即将过期的用户发送电子邮件，请选择**将电子邮件发送给其文件即将过期的用户**复选框。

        -   若要配置邮件，请编辑所提供的默认主题行和邮件正文。 方括号中的文本会插入关于导致通知的配额事件的变量信息。 例如， **\[源文件所有者\]** 变量插入其文件即将过期的用户的名称。 若要在文本中插入其他变量，请单击**插入变量**。

        -   若要附加即将过期的文件列表，请单击**附加到将对其执行操作的文件的电子邮件列表**，并为**该列表中文件的最大数目**键入或选择一个值。

        -   若要配置其他标题（包括发件人、抄送、密件抄送和回复），请单击**其他电子邮件标题**。  

    -   若要记录事件，请单击**事件日志**选项卡并选中**将警告发送至事件日志**复选框，然后编辑默认的日志项目。  

    -   若要运行命令或脚本，请单击**命令**选项卡，选中**运行该命令或脚本**复选框。 然后键入命令，或单击**浏览**以搜索脚本的存储位置。 还可以输入命令参数、选择命令或脚本的工作目录，或者修改命令安全设置。

6.  另外，可使用“报告”选项卡生成一个或多个日志或存储报告。

    -   若要生成日志，请选中**生成日志**复选框，然后选择一个或多个可用日志。  

    -   若要生成报告，请选中**生成报告**复选框，然后选择一个或多个可用报告格式。  

    -   若要创建电子邮件生成的日志或存储报告，请选中**将报告发送至下列管理员**复选框，然后使用 *account@domain* 格式键入一个或多个管理电子邮件收件人。 使用分号分隔多个地址。

     > [!Note]
     > 报告将被保存在事件报告的默认位置，你可以在“文件服务器资源管理器选项”对话框中修改该位置。
        
7. 另外，可使用“条件”选项卡仅对与定义的一组条件匹配的文件运行该任务。 提供了下列设置：

    -   **属性条件**。 单击**添加**，基于文件分类创建新条件。 此操作将打开**属性条件**对话框，可通过该对话框选择属性、在该属性上执行的运算符以及与该属性相较的值。 单击**确定**后，可创建其他条件，或编辑/删除现有条件。

    -   **上次修改文件以来的天数**。 单击复选框，然后在调整框中输入天数。 此操作将会使文件管理任务仅应用于超过指定天数未经修改的文件。

    -   **自上次访问文件以来的天数**。 单击复选框，然后在调整框中输入天数。 如果将服务器配置为跟踪上次访问文件的时间戳，则文件管理任务将仅应用于超过指定天数未被访问的文件。 如果未将服务器配置为跟踪访问次数，则该条件无效。

    -   **创建文件以来的天数**。 单击复选框，然后在调整框中输入天数。 此操作将会使该任务仅应用于至少在指定天数前创建的文件。  

    -   **有效启动时间**。 设置该文件管理任务应开始处理文件的日期。 此选项可用于延迟任务，为你提供提前通知用户或进行其他准备的时间。

8.  单击**计划**选项卡上的**创建计划**，然后在**计划**对话框中单击**新建**。 此操作会显示设置为每天上午 9:00 的默认计划， 但可以修改默认计划。 在完成计划配置后，请单击**确定**，然后再次单击**确定**。

## <a name="see-also"></a>请参阅

-   [分类管理](classification-management.md)
-   [文件管理任务](file-management-tasks.md)